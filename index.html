<!DOCTYPE html>
<html>
<head lang="en">
    <script src="svgUtil.js"></script>
    <script src="pixelUtil.js"></script>
    <meta charset="UTF-8">
    <title></title>
</head>

<body >

<canvas id=myCanvas width="150" height="150"></canvas>

<script>

    function imageLoaded(ev) {
        element = document.getElementById("myCanvas");
        c = element.getContext("2d");

        im = ev.target; // the image, assumed to be 200x200

        // read the width and height of the canvas
        width = element.width;
        height = element.height;

        // stamp the image on the left of the canvas:
        c.drawImage(im, 0, 0);

        // get all canvas pixel data
        imageData = c.getImageData(0, 0, width, height);

        var head = "<svg xmlns='http://www.w3.org/2000/svg' width='150' height='150'>";
        var body = "";

        var unit = 2;

        for (y = 0; y < height; y++ ){
            for (x = 0; x < width; x++ ) {
                //setPixel(imageData, x, y, 255, 0, 0, 255); // 255 opaque
                var color = getPixel(imageData, x, y);

                var redux = color.reduce(function(a,b){
                    return a+b;
                });

                if (redux > 0){
                    var strColor = color[0]+","+color[1]+","+color[2];
                    console.log(strColor);
                    body += "<rect x='"+String(x*unit)+"' y='"+String(y*unit)+"' width='"+String(unit)+"' height= '"+String(unit)+"' style='fill:rgb("+strColor+")'/>\r\n";

                }
            }
        }

        var tail = "</svg>";

        drawSVGString(head+"\r\n"+body+"\r\n"+tail);

        // put pixel data on canvas
        c.putImageData(imageData, 0, 0);
    }

    im = new Image();
    im.onload = imageLoaded;
    im.src = "mario.gif";

</script>

<br>

<button onclick="drawSVG()">Try it</button>
<br>
<textarea id="generatedSVG">

</textarea>
<br>
<div id="svgContainer" width='150' height='150'>

</div>

<br>

<!--<svg width="400" height="110" id="">-->
    <!--<rect x="1" y="10" width="1" height="1" style="fill:rgb(0,0,255)"/>-->
    <!--<rect x="0" y="10" width="1" height="1" style="fill:rgb(0,255,255)"/>-->
<!--</svg>-->

</body>
</html>